{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Linear Regression\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1. 線性迴歸"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 直線\n",
    "\n",
    "$$f(x) = 1.2x + 0.8$$\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.         0.10204082 0.20408163 0.30612245 0.40816327 0.51020408\n",
      " 0.6122449  0.71428571 0.81632653 0.91836735 1.02040816 1.12244898\n",
      " 1.2244898  1.32653061 1.42857143 1.53061224 1.63265306 1.73469388\n",
      " 1.83673469 1.93877551 2.04081633 2.14285714 2.24489796 2.34693878\n",
      " 2.44897959 2.55102041 2.65306122 2.75510204 2.85714286 2.95918367\n",
      " 3.06122449 3.16326531 3.26530612 3.36734694 3.46938776 3.57142857\n",
      " 3.67346939 3.7755102  3.87755102 3.97959184 4.08163265 4.18367347\n",
      " 4.28571429 4.3877551  4.48979592 4.59183673 4.69387755 4.79591837\n",
      " 4.89795918 5.        ]\n"
     ]
    }
   ],
   "source": [
    "#準備 50 個點\n",
    "x = np.linspace(0, 5, 50)\n",
    "print(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.8       , 0.92244898, 1.04489796, 1.16734694, 1.28979592,\n",
       "       1.4122449 , 1.53469388, 1.65714286, 1.77959184, 1.90204082,\n",
       "       2.0244898 , 2.14693878, 2.26938776, 2.39183673, 2.51428571,\n",
       "       2.63673469, 2.75918367, 2.88163265, 3.00408163, 3.12653061,\n",
       "       3.24897959, 3.37142857, 3.49387755, 3.61632653, 3.73877551,\n",
       "       3.86122449, 3.98367347, 4.10612245, 4.22857143, 4.35102041,\n",
       "       4.47346939, 4.59591837, 4.71836735, 4.84081633, 4.96326531,\n",
       "       5.08571429, 5.20816327, 5.33061224, 5.45306122, 5.5755102 ,\n",
       "       5.69795918, 5.82040816, 5.94285714, 6.06530612, 6.1877551 ,\n",
       "       6.31020408, 6.43265306, 6.55510204, 6.67755102, 6.8       ])"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y = 1.2*x + 0.8\n",
    "y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x23737a084a8>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#畫圖\n",
    "plt.scatter(x,y)\n",
    "plt.plot(x, 1.2*x+0.8, 'r')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### add noise \n",
    "\n",
    "$$f(x) + \\varepsilon(x)$$\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 0.85529535 -0.20750179  1.98110383  1.46611209  1.89930835  0.66992277\n",
      "  2.48661665  1.42835981  1.14287868  2.16864772  2.16102537  1.48895302\n",
      "  2.67280144  2.51977906  2.61318225  1.06780488  2.6463725   1.82338293\n",
      "  2.9524967   2.87333423  4.22965225  2.46441162  3.38091916  4.22669757\n",
      "  4.89978373  4.38807475  4.23873627  3.72621185  4.08661907  4.05130342\n",
      "  4.62268089  5.02854348  4.83319296  4.12537617  6.51160079  5.3774786\n",
      "  6.1407049   5.48913763  5.51967703  4.82584722  5.37609399  6.42538241\n",
      "  5.96839835  6.36929298  7.03179684  6.30855351  6.00176819  7.8601521\n",
      "  6.60815411  6.32541646]\n"
     ]
    }
   ],
   "source": [
    "y = 1.2*x + 0.8 + 0.6*np.random.randn(50)\n",
    "print(y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x23737d26940>]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x,y)\n",
    "plt.plot(x, 1.2*x + 0.8, 'r')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LinearRegression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "regr = LinearRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(50,)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(50, 1)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(x.shape)\n",
    "X = x.reshape(-1,1)\n",
    "X.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "$$[x_1, x_2, \\ldots, x_{50}]$$\n",
    "\n",
    "==> \n",
    "\n",
    "$$[[x_1], [x_2], \\ldots, [x_{50}]]$$\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None,\n",
       "         normalize=False)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "regr.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.70776908 0.83655527 0.96534146 1.09412765 1.22291383 1.35170002\n",
      " 1.48048621 1.6092724  1.73805858 1.86684477 1.99563096 2.12441715\n",
      " 2.25320334 2.38198952 2.51077571 2.6395619  2.76834809 2.89713427\n",
      " 3.02592046 3.15470665 3.28349284 3.41227903 3.54106521 3.6698514\n",
      " 3.79863759 3.92742378 4.05620996 4.18499615 4.31378234 4.44256853\n",
      " 4.57135472 4.7001409  4.82892709 4.95771328 5.08649947 5.21528565\n",
      " 5.34407184 5.47285803 5.60164422 5.73043041 5.85921659 5.98800278\n",
      " 6.11678897 6.24557516 6.37436134 6.50314753 6.63193372 6.76071991\n",
      " 6.8895061  7.01829228]\n"
     ]
    }
   ],
   "source": [
    "Y = regr.predict(X)\n",
    "print(Y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'copy_X': True, 'fit_intercept': True, 'n_jobs': None, 'normalize': False}"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#了解你的訓練參數\n",
    "regr.get_params()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.40948727720492434\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x, y)\n",
    "plt.plot(x, Y, 'ro')\n",
    "#calculate mse\n",
    "mse = np.sum((Y-y)**2) / len(y)\n",
    "print(mse)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. 函數訓練and測試\n",
    "\n",
    "#### 訓練資料、測試資料\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "80%  training data, 20%  testing data ==> 先利用此來驗證各種模型(演算法)的好壞及調好到最佳參數\n",
    "之後可以利用由這個80%的訓練資料所得的模型後,拿100%資料re-train模型以得到最佳模型 (此model會更佳fit data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[3.36734694 3.57142857 2.65306122 3.46938776 1.83673469 0.71428571\n",
      " 1.42857143 4.59183673 4.89795918 2.95918367 1.53061224 3.06122449\n",
      " 3.26530612 1.63265306 4.28571429 2.04081633 4.3877551  0.81632653\n",
      " 1.32653061 2.55102041 0.51020408 1.73469388 4.08163265 5.\n",
      " 0.10204082 1.2244898  3.7755102  2.44897959 0.6122449  2.34693878\n",
      " 3.67346939 2.14285714 1.93877551 0.91836735 3.97959184 4.69387755\n",
      " 0.30612245 0.         4.79591837 4.48979592]\n"
     ]
    }
   ],
   "source": [
    "x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=0)\n",
    "print(x_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x2373a5a8438>"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x_train, y_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 用訓練資料來 fit 函數\n",
    "\n",
    "記得現在我們只用 80% 的資料去訓練。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Coefficients:  [1.29037475]\n",
      "interception:  0.6083629388134932\n"
     ]
    }
   ],
   "source": [
    "regr = LinearRegression()\n",
    "X_train = x_train.reshape(-1,1)\n",
    "regr.fit(X_train,y_train)\n",
    "print('Coefficients: ', regr.coef_)\n",
    "print('interception: ', regr.intercept_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "Y_train = regr.predict(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.4465274588937419\n"
     ]
    }
   ],
   "source": [
    "mse = np.sum((Y_train-y_train)**2) / len(y_train)\n",
    "print(mse)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x2373a5a8a58>]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x_train, y_train)\n",
    "plt.plot(x_train, Y_train, 'r')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### test with test data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[2.85714286]\n",
      " [1.12244898]\n",
      " [1.02040816]\n",
      " [4.18367347]\n",
      " [0.20408163]\n",
      " [2.75510204]\n",
      " [3.87755102]\n",
      " [3.16326531]\n",
      " [2.24489796]\n",
      " [0.40816327]]\n",
      "[4.29514795 2.05674276 1.92507187 6.00686956 0.87170473 4.16347705\n",
      " 5.61185688 4.69016063 3.50512259 1.13504651]\n"
     ]
    }
   ],
   "source": [
    "X_test = x_test.reshape(-1,1)\n",
    "Y_test = regr.predict(X_test)\n",
    "print(X_test)\n",
    "print(Y_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\widehat{y}=xw+b=w_{1}x_{1}+b$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[4.29514795],\n",
       "       [2.05674276],\n",
       "       [1.92507187],\n",
       "       [6.00686956],\n",
       "       [0.87170473],\n",
       "       [4.16347705],\n",
       "       [5.61185688],\n",
       "       [4.69016063],\n",
       "       [3.50512259],\n",
       "       [1.13504651]])"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Y=WX+b\n",
    "W=regr.coef_\n",
    "b=regr.intercept_\n",
    "W*X_test+b\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.2741186503858739\n"
     ]
    }
   ],
   "source": [
    "mse = np.sum((Y_test-y_test)**2) / len(y_test)\n",
    "print(mse)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x23738504f98>"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x_test, y_test)\n",
    "plt.scatter(x_test, Y_test, c='r')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3. Nonlinear\n",
    "\n",
    "$$f(x) = \\sin(3.2x) + 0.8x$$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3. 生成假資料"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "x = np.linspace(0, 5, 100)\n",
    "y = np.sin(3.2*x) + 0.8*x + 0.3*np.random.randn(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x2373a6da518>"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAW4AAAD8CAYAAABXe05zAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAF35JREFUeJzt3V+MXGd5x/HfE3errELKXmSLknW2tlQUpBLVLqOo0kpVswKSkgiscBFawVUl35QqMVXQ5qrlooqrSJBecGMBqipaYqQQCyUUE8lGKFaB7OKFEJxUiCYia1QbwQqiWOCEpxe7Y48n5897Zs6Z877nfD+SFe/67Mw7k9ln3vmd532PubsAAOm4ru0BAACqoXADQGIo3ACQGAo3ACSGwg0AiaFwA0BiKNwAkBgKNwAkhsINAIn5vSZu9KabbvJ9+/Y1cdMA0EkbGxs/d/fFkGMbKdz79u3T+vp6EzcNAJ1kZq+EHktUAgCJoXADQGIo3ACQGAo3ACSGwg0AiaFwA0BiGmkHBIAYnTi7pUdPvqTz25d0y8K8HrrrNh06uNT2sCqjcAPohRNnt/TwV57XpctvSpK2ti/p4a88L0nJFW+iEgC98OjJl64U7aFLl9/UoydfamlEk2PGDaATymKQ89uXMn8u7/sxY8YNIHnDGGRr+5JcV2OQE2e3rhxzy8J85s/mfT9mFG4AyQuJQR666zbNz+255pj5uT166K7bZjLGOgUVbjN72cyeN7NNM2P3KABRCYlBDh1c0iP33a6lhXmZpIX5OV0/d52OHN/UytFT18zOY1dlxn2nux9w90FjowGACYTGIIcOLunM2qo+c/8B/eaN3+mXr1/OjVZiRlQCIHlVY5DUO0xCC7dL+oaZbZjZ4awDzOywma2b2frFixfrGyEAlBiPQZYW5vXIfbfn9men3mES2g644u7nzewPJT1jZi+6+7dGD3D3Y5KOSdJgMPCaxwkAhQ4dXLpSqIetgUeOb2a2Bt6yMK+tjCKdSodJ0Izb3c/v/veCpCcl3dHkoABgUiGtgal3mJQWbjO7wcxuHP5d0vsl/bDpgQHAJELy66rRSmxCopJ3SHrSzIbH/6e7f73RUQHAhELz69FoJTWlhdvdfyLpT2cwFgA9V8fufann1yFoBwQQhZBsOkRWfm27t5faQps8FG4AUairt3o0v5Z2ivawzS21hTZ5KNwAolBnb/VwheTSwrzGe5NTWmiTh8INIApN7N6X+kKbPBRuAFFoore6S1u5jqJwA4hCE73VqS+0ycMVcABEo+7e6uFtdeECwaMo3AA6LeWFNnmISgAgMcy4ASSljtWVqaNwA0jGcHXlcKHOcEGNpF4Vbwo3gGQUra6sq3CnMKOncANIRtMLalKZ0VO4ASSjqZ3/hrPsrNuue0ZfBwo3gChlRRYP3XXbNTNiafoFNeOz7CyxLZGnHRBAdPK2eJV0zerKhfk5XT93nY4c35x4y9as3HxcbEvkmXEDiE7eScgHj29qaXf2LamWPLpsNh3jEnkKN4DoFBXTYYG+fu66WjpM8nJzSVfeJGLKtyWiEgARKosmLl1+U798/XLmv1XNo/M2onrs/gM6s7YaXdGWKNwAIpRVTENVzaNTvOI7UQmA6Izu6pcXYyzMz+k3b/yulg6T1DaiYsYNIErDy489dv+BzCjjnz74J8nNlOvCjBtA1Mr21O5DoR5H4QYQvRiijJj2MKFwA2hVTAUxT2x7mJBxA2hN3grJSVZANqloV8I2ULgBtCa2gpin6V0Jq6JwA2hNbAUxT15veFt7mAQXbjPbY2ZnzeypJgcEoHtOnN3SytFT2r/29DWbQcVWEPPkra5saw+TKjPuBySda2ogALqpKMeOrSDmyVpd+eH3LOnRky+95c1oFoK6Ssxsr6R7JP2zpE80OiIAnVKUY59ZW71yTMxdJdK1LYltd5mEtgM+JumTkm7MO8DMDks6LEnLy8vTjwxAJ5Tl2DH0aFc1i2tfFimNSszsXkkX3H2j6Dh3P+buA3cfLC4u1jZAAGlLJceuou2TqiEZ94qkD5rZy5Iel7RqZl9sdFQAOiOVHLuKtt+MSgu3uz/s7nvdfZ+kj0g65e4fbXxkADohthN7dWj7zYgl7wAakbeUve0Te3Uo2/iqaebutd/oYDDw9fX12m8XQBqyrpw+P7dHj9x3e+4e20sL81e6TPrIzDbcfRByLCsnAdSuqOui7RN7XUDhBlC7ouLc9om9LqBwA6hdUXFu+8ReF1C4AdSuqDineHHe2NBVAqB2IZcbS6FQh17kYdYXg6BwA2hEKsU5T2jbYhvtjUQlAJAh9CIPbVwMgsINABlC2xbbaG+kcANAhtC2xTbaGyncAJAhtG2xjfZGTk4CQIbQ/Uja2LeEvUqAMbNu7QKkanuVMOMGRnRh5zp0H4UbnVDXLLntS1IBISjcSF6ds2R2rkMK6CpB8upcAMHOdUgBhRvJq3OWzM51SAFRCZJ3y8J85hVVJpklt31JqtTRkTMbFG4k76G7bsu8TNaks+TUN0eatWGx3tq+JJM0bDCmI6c5RCVIHvs7t2d4Ynj4iWd8VUjTmy31FTNudAKz5HZknRgeR0dO/ZhxA5hYSFGmI6d+FG4AEysrynTkNIOoBECQrI6RrBPDwxOUS3SVNIZNpgCUGl+dKu3Mph+573ZJtE/WgU2mANSqaHXqmbVVCvWMkXEDKMUeLnGhcAMoxR4ucSkt3GZ2vZl918y+b2YvmNmnZjEwAPFgD5e4hGTcv5G06u6vmdmcpGfN7L/c/dsNjw2YGfbYKMYeLnEpLdy+03by2u6Xc7t/6m9FAWaMPTaqYXVqPIK6Ssxsj6QNSX8s6bPu/p1GRwXUJG8mPd7eVrTHBrNMxKZSH7eZLUh6UtLfu/sPx/7tsKTDkrS8vPyeV155pc5xApUV9R4PZ9pl5uf2ZP48xRt1q9LHXamrxN23JX1T0t0Z/3bM3QfuPlhcXKxys0AjinqPQ9rY9pjVdmUdoE6lUYmZLUq67O7bZjYv6b2S/qXxkQFTyivOk8y0Q263TziZ266QGffNkk6b2Q8kPSfpGXd/qtlhAdOr2mNsu/8d7ue9RO9yptE9uF1XT+aeOLvV9tB6I6Sr5AeSDs5gLECtsjZAypO3IVKdV9bpiqIIiln3bLBXCTprvPc47zS8STqztlr680QCO1j+3j4KN5JSNVsd7T1eOXqq8kWFR39+eN9Hjm/2uojXeXFmTIa9SpCMabPVaZZtk+texfL39jHjRjJCs9W8Wfk00ce0990lREjto3AjGSHZ6viim/Hl65Mu2y667z4unWf5e7uISpCMkK1Fi2bGTdz32+fnrkQoUvHSeaAuFG4kIyRbbarjIe++zVTabki3BepG4UYyDh1curIwxnR1oczoR/amNvzPu+/t1y+X/izdFqgbGTeSUpatZi26qavjIeu+yzarotsCTWDGjU4JmZXXKStCGV86n/JJvBNnt7Ry9JT2rz2tlaOnetn+GCNm3OicWXY8dLk1rqxDB+2hcCNZbfZM96Ffmz1J4kXhRpLanA32ZSbKniTxIuNGkprq1571fcecITfVoYPpMeNGktqcDdZ13zHN3LOinyY7dDAdZtxIUpuzwbruu81PDaPyNtCSNNMOHYRjxo0ktTkbrOu+Y8mQi95AzqytUqgjROFGktpsw6vrvmPZ1zqWNxCEo3AjWW3uUFf1vmPOkGN5A0E4Mm6gYbFnyFwYIT3MuIGGxZ4hd3n1Z1dRuIGGpZAhc2GEtFC4gYa1kSH3YUl+n5FxAw2bdYbMhY27j8INNGzWW83GsrAHzSEqAWZglhlyCpk6pkPhRvTIa6uZNlPn+Y4fUQmi1sW8tukdAafJ1Lv4fHdRaeE2s1vN7LSZnTOzF8zsgVkMDJC6l9fOojBOk6l37fnuqpCo5A1J/+Du3zOzGyVtmNkz7v6jhseGHht+XM+7EG+qee2sriozaaZOPp6G0sLt7j+T9LPdv//azM5JWpJE4UawkNx0tFibJC+4vVT30Yi9MLJvSRoqZdxmtk/SQUnfaWIw6KaQeGD0GKm4aKe8j0bRXt4xXA2HfUvSEFy4zextkp6Q9KC7/yrj3w+b2bqZrV+8eLHOMSJxIblp1jFZUtrMP6sQ5xXGO9+1GMVJwVn3nGMy5l40t9k9yGxO0lOSTrr7p8uOHwwGvr6+XsPw0AX7157OnEGbpP89ek/hMaOWFuZ1Zm217uE1YvyyZNJOgX7kvtslvXVDp7w8P6XHjOmY2Ya7D0KOLc24zcwkfV7SuZCiDYwLyU3zjhlK7eN61R0BjxzfzLydOrJv+rK7JyQqWZH0MUmrZra5++cDDY8LHRKSm2YdY7v/TfHjetWTkE1l3/Rld1NIV8mzuvo7BFQWst9z1/aErtqdkXc1nGH2PemV4PNm/g8e39SjJ19K+jnus6CMuyoybvRdUcadVyizIo1ps++ycwdlY8Ls1Jpxd8k0WR85IaqY5BNE1qKZabPvsnMHTSz+QfN6U7jHZ0BVPnJO87Porzp2BCyLXMomFFkRzLhYFv8gXG82mSrK+spO+LB/A9pSdGI35MTjaF92HlZFpqc3hbtoVlF2pj32ZcqpiWGFYCqKFsSETigOHVzSmbVVPXb/AVZFdkRvopJpsj72b6hPVux05PimHjy+qSXOHWTKi1yqTii61rnTZ70p3JNkfUWbHjFTmUzWLHH4vHLuoJpJJhRczb0behOVVM36sjY9SnlBSCzK4iXOHYRjQ6j+6s2MW7o628jrsR19wefNDNk7IlxWx0NZZCVx7iAU0Ud/9apwD4W84EPzQ/q7s+W1UH74PUt6YmOrMLLi3EG4aaIPXrvp6mXhlspf8CH5If3d+fI6Hk6/eFGP3Hc75w5axms3bb3JuKsKyQ/p785X9Ill2J728tF79Jn7D7D3cwt47aattzPuMnXGKX0U2vFAl0M7eO2mjcJdoI44pa/ydrsjBpleHdk0r920EZVMgXasfFwCqxl17a/NazdtzLinQDtWMWKQ+hVl01Wea167aetk4Z5lmxPFCU3Iew3XmU3z2k1X5wo3bU5IXdFrmGwaUgczbtqckLqi1zDZNKQOzrhpc0LqynrgpexsmpWQ/dG5wp33UdIlrRw9NbMXM79EmFRZHJKVTRMR9kvnopKsj5JDk7ZOjSu7EEBdLVvop0niECLCfulc4S7bvnXaF3NIUeaXCNOYpAeeiLBfOheVSFc/Su5fe/qaDYyGil7MZRFHSB8tv0SYVtVWPbpN+qVzM+5ReS/avO+HzKZDinLV+wWmRbdJv3S6cIe+mIeZ9YPHN0sjjpCi3LdfIi7+2z62GOiXTkYlQyHLerOuhjNudDYdsnlSn5YT080QD1ZC9kfShTuk5a7sxZyVWY8bnU2HFuW+/BLVtXcGgHClhdvMviDpXkkX3P3dzQ8pTF0zvbIThlkRR1+Kcoi8529r+9JM++aBPgnJuP9N0t0Nj6Oyulruik4YVs0J+5j1Fj1/9K8DzSgt3O7+LUm/mMFYggyLY96Vwqu23OWdSHzs/gM6s7ZaqWj3cdFN0YInif51oAlJdZWMFsc8VVvu6job39dFN2ULniT614G61XZy0swOSzosScvLy3Xd7DXKTiRO2nJXR2bd50U3w+cv75MQ/etAvWqbcbv7MXcfuPtgcXGxrpu9RlERbLtvlUU3/etfB9qSVDtg3rLepYV5nVlbbWFEVxX1d4+3Ld75rkWdfvFi53q8+9S/DrTJ3LN28xg5wOxLkv5S0k2S/k/SP7r754t+ZjAY+Pr6el1jvCJrscz83J5oVohl9ZVLKl3gE9NjANAOM9tw90HQsWWFexJNFW4pvX2uizpgRo1/aojtccY2HqBrqhTupKISKf9EYqyFJfTk5OhxsS0jj208QN8l1Q6YJ+Ye6tCTk6PHzaK1sMpiob62OgKx6kThjrmwlC1Qkd7aedF0a2HVN7o+tzoCMepE4Y65sGQt8Pnony8XLvhpurWw6hsdrY5AXJLLuLPEfvWPqgt8QraOnUbVN7qmxwOgmk7MuLu28KPpTfGrzqDZpB+IS3LtgHli7SqJUez98EAfdbodMA97ZIdjhSOQts4UblTDGx2Qrk5k3ADQJxRuAEgMUUnLOKkKoCoKd4vYAwTAJIhKWhTzUn0A8WLG3aJJluoTrQCIvnB3uVBVXapPtAJAijwqiXm71jpkLdU37TzOrK1WiVYASJHPuIsKVRdmmKMrGLe2L8kkDTcgyJpNN7ULYpc/1QBdFHXhjnm71roMVzBmXeJs/E2qKFoZLb5vn5+TmbT9+uXSQjxp/EKxB9oTdVTSp32gQ96k8nZBvPNdi9dEStuXLuuXr18OipcmiV+6HmEBsYu6cHdtu9YiIW9Sedurnn7xYuFV5IsK8SSfasjagXZFHZX0aRe70IsVZG0OdeT4Zunt5xXi0Phl9LnvQ4QFxCyawp1XJPqyi13Rm1RZnpxXfEflzejz3jCG8UtW9h37FYeArouicNOfvCPrTSrkuckqvqOK4qW8N4yiOIRLmQHtiqJwd73tbxohz8148a3SVTL8+dD45fz2pV5FWECMoijcZKb5Qp+bkEipSgtfWRzSlwgLiFEUXSV9avurqui5OXF2SytHT2n/2tOZKy1HVW3h61NHD5CaKAp31aXffRLau113vzZXdgfiFRSVmNndkv5V0h5Jn3P3o3UOourS7z6Z5ORh1vM0SRxFHALEqbRwm9keSZ+V9D5Jr0p6zsy+6u4/qnMgVZZ+903Vk4dZQlv4WMoOxC8kKrlD0o/d/Sfu/ltJj0v6UFMD4kRlmKrnBUIya5ayA2kIKdxLkn468vWru99rBCcqw1Q9eRiSWbOUHUhDSMZtGd/ztxxkdljSYUlaXl6eeEAs7ggzSS91WWbNpx0gDSGF+1VJt458vVfS+fGD3P2YpGOSNBgM3lLYQ7G4I9yse7cBxCGkcD8n6Z1mtl/SlqSPSPqbJgdFN0M9qm4lwKcdIA2lGbe7vyHp45JOSjon6cvu/kLTA8P06N0Guimoj9vdvybpaw2PBTWjdxvopihWTqIZdOgA3UTh7jD2GwG6KYrdAdEMOnSAbqJwdxyZNdA9RCUAkBgKNwAkhsINAImhcANAYijcAJAYCjcAJMbcJ97IL/9GzS5KemXCH79J0s9rHE4KeMzd17fHK/GYq/ojd18MObCRwj0NM1t390Hb45glHnP39e3xSjzmJhGVAEBiKNwAkJgYC/extgfQAh5z9/Xt8Uo85sZEl3EDAIrFOOMGABSIqnCb2d1m9pKZ/djM1toeT9PM7AtmdsHMftj2WGbBzG41s9Nmds7MXjCzB9oeU9PM7Hoz+66ZfX/3MX+q7THNgpntMbOzZvZU22OZBTN72cyeN7NNM1tv/P5iiUrMbI+k/5H0Pu1cWf45SX/t7j9qdWANMrO/kPSapH9393e3PZ6mmdnNkm529++Z2Y2SNiQd6vj/Y5N0g7u/ZmZzkp6V9IC7f7vloTXKzD4haSDpD9z93rbH0zQze1nSwN1n0rce04z7Dkk/dvefuPtvJT0u6UMtj6lR7v4tSb9oexyz4u4/c/fv7f7919q5+HSnNwv3Ha/tfjm3+yeO2VJDzGyvpHskfa7tsXRVTIV7SdJPR75+VR3/pe4zM9sn6aCk77Q7kubtxgabki5Iesbdu/6YH5P0SUm/a3sgM+SSvmFmG2Z2uOk7i6lwW8b3Oj0z6Ssze5ukJyQ96O6/ans8TXP3N939gKS9ku4ws87GYmZ2r6QL7r7R9lhmbMXd/0zSX0n6u90YtDExFe5XJd068vVeSedbGgsaspvzPiHpP9z9K22PZ5bcfVvSNyXd3fJQmrQi6YO7me/jklbN7IvtDql57n5+978XJD2pnei3MTEV7uckvdPM9pvZ70v6iKSvtjwm1Gj3RN3nJZ1z90+3PZ5ZMLNFM1vY/fu8pPdKerHdUTXH3R92973uvk87v8On3P2jLQ+rUWZ2w+7JdpnZDZLeL6nRTrFoCre7vyHp45JOauek1Zfd/YV2R9UsM/uSpP+WdJuZvWpmf9v2mBq2Iulj2pmFbe7++UDbg2rYzZJOm9kPtDM5ecbde9Ei1yPvkPSsmX1f0nclPe3uX2/yDqNpBwQAhIlmxg0ACEPhBoDEULgBIDEUbgBIDIUbABJD4QaAxFC4ASAxFG4ASMz/A46BjuHyLs0AAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x,y)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### nonlinear"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "regr_lin = LinearRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(100, 1)\n"
     ]
    }
   ],
   "source": [
    "X = x.reshape(-1, 1)\n",
    "print(X.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None,\n",
       "         normalize=False)"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "regr_lin.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.639314801073646\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "Y=regr_lin.predict(X)\n",
    "plt.scatter(x,y)\n",
    "plt.plot(x,Y , 'r')\n",
    "mse = np.sum((Y-y)**2) / len(y)\n",
    "print(mse)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "果然超級不準, 該如何是好?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 多項式\n",
    "\n",
    "多項式5次方"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(100, 5)\n"
     ]
    }
   ],
   "source": [
    "X_poly = np.array([[k, k**2, k**3, k**4, k**5] for k in x])  # add k**6 to try it\n",
    "print(X_poly.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "regr_poly = LinearRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None,\n",
       "         normalize=False)"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "regr_poly.fit(X_poly, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x2373a75d4e0>]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x,y)\n",
    "plt.plot(x, regr_poly.predict(X_poly), 'r')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Coefficients:  [-1.88820693  2.43301362 -1.09544434  0.23099068 -0.01773054]\n",
      "interception:  1.179774010108439\n"
     ]
    }
   ],
   "source": [
    "print('Coefficients: ', regr_poly.coef_)\n",
    "print('interception: ', regr_poly.intercept_)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$\\widehat{y}=xw+b=w_{1}x_{1}+w_{2}x_{2}+w_{3}x_{3}+w_{4}x_{4}+w_{5}x_{5}+b$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1.17977401, 1.09047643, 1.01276506, 0.94584638, 0.88896158,\n",
       "       0.84138579, 0.80242743, 0.7714275 , 0.74775885, 0.73082552,\n",
       "       0.72006204, 0.7149327 , 0.71493087, 0.71957831, 0.72842444,\n",
       "       0.74104568, 0.75704473, 0.77604986, 0.79771423, 0.8217152 ,\n",
       "       0.84775357, 0.87555299, 0.90485913, 0.9354391 , 0.96708068,\n",
       "       0.99959163, 1.032799  , 1.06654845, 1.10070352, 1.13514493,\n",
       "       1.16976992, 1.2044915 , 1.2392378 , 1.27395131, 1.30858826,\n",
       "       1.34311784, 1.37752155, 1.41179251, 1.44593471, 1.47996236,\n",
       "       1.51389917, 1.54777764, 1.58163838, 1.61552941, 1.64950546,\n",
       "       1.68362725, 1.71796081, 1.75257678, 1.78754973, 1.8229574 ,\n",
       "       1.85888006, 1.89539981, 1.93259982, 1.97056371, 2.00937479,\n",
       "       2.04911539, 2.08986618, 2.1317054 , 2.17470825, 2.21894611,\n",
       "       2.26448591, 2.31138939, 2.3597124 , 2.40950422, 2.46080685,\n",
       "       2.51365432, 2.56807197, 2.62407576, 2.68167161, 2.74085462,\n",
       "       2.80160846, 2.86390459, 2.92770162, 2.99294459, 3.05956427,\n",
       "       3.12747644, 3.19658124, 3.26676244, 3.33788671, 3.409803  ,\n",
       "       3.48234177, 3.55531432, 3.62851209, 3.70170595, 3.77464553,\n",
       "       3.84705846, 3.91864975, 3.98910104, 4.0580699 , 4.12518915,\n",
       "       4.19006615, 4.25228212, 4.31139141, 4.36692082, 4.4183689 ,\n",
       "       4.46520524, 4.50686979, 4.54277214, 4.57229083, 4.59477267])"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "W=regr_poly.coef_\n",
    "b=regr_poly.intercept_\n",
    "np.dot(X_poly,W.T)+b"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### RBF\n",
    "\n",
    "$$\\phi_i = e^{-\\| x - c_i \\|^2/2\\sigma^2}$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "def RBF(x, center, sigma):\n",
    "    k = np.exp(-(x - center)**2/(2*sigma**2))\n",
    "    return k"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "sigma = 0.3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-38-3b84634ba9b9>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-38-3b84634ba9b9>\"\u001b[1;36m, line \u001b[1;32m1\u001b[0m\n\u001b[1;33m    X_rbf = np.array([[RBF(k, ..5, sigma),\u001b[0m\n\u001b[1;37m                              ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "X_rbf = np.array([[RBF(k, ..5, sigma), \n",
    "                  RBF(k, 1.5, sigma),\n",
    "                  RBF(k, 2.5, sigma),\n",
    "                  RBF(k, 3.5, sigma),\n",
    "                  RBF(k, 4.5, sigma)] for k in x])\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "regr_rbf = LinearRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "regr_rbf.fit(X_rbf, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "plt.scatter(x,y)\n",
    "plt.plot(x, regr_rbf.predict(X_rbf), 'r')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print('Coefficients: ', regr_rbf.coef_)\n",
    "print('interception: ', regr_rbf.intercept_)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Y_lin = regr_lin.predict(X)\n",
    "Y_poly = regr_poly.predict(X_poly)\n",
    "Y_rbf = regr_rbf.predict(X_rbf)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "plt.scatter(x,y)\n",
    "\n",
    "plt.plot(x, Y_lin, label='linear')\n",
    "plt.plot(x, Y_poly, label='polynomial')\n",
    "plt.plot(x, Y_rbf, label='rbf')\n",
    "plt.legend()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "## 請計算模型的MSE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(np.sum((regr_lin.predict(X)-y)**2) / len(y))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(np.sum((regr_poly.predict(X_poly)-y)**2) / len(y))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(np.sum((regr_rbf.predict(X_rbf)-y)**2) / len(y))"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
