{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Logistic Regression for multi-class problem"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "from sklearn import datasets\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "import os,sys\n",
    "sys.path.append(os.path.abspath('../../common')) #for import common.utility\n",
    "from utility import plot_confusion_matrix,plot_decision_regions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.24.2\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "print(pd.__version__)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 載入Iris資料集\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "600\n",
      "target_names: ['setosa' 'versicolor' 'virginica']\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sepal length (cm)</th>\n",
       "      <th>petal length (cm)</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4.9</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4.7</td>\n",
       "      <td>1.3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4.6</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>4.6</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>4.4</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>4.9</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>4.8</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>4.8</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>4.3</td>\n",
       "      <td>1.1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>5.8</td>\n",
       "      <td>1.2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>5.7</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>5.7</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>4.6</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>4.8</td>\n",
       "      <td>1.9</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>5.2</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>5.2</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>4.7</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>6.9</td>\n",
       "      <td>5.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>121</th>\n",
       "      <td>5.6</td>\n",
       "      <td>4.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>7.7</td>\n",
       "      <td>6.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123</th>\n",
       "      <td>6.3</td>\n",
       "      <td>4.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>7.2</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>6.2</td>\n",
       "      <td>4.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127</th>\n",
       "      <td>6.1</td>\n",
       "      <td>4.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>128</th>\n",
       "      <td>6.4</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129</th>\n",
       "      <td>7.2</td>\n",
       "      <td>5.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>130</th>\n",
       "      <td>7.4</td>\n",
       "      <td>6.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>131</th>\n",
       "      <td>7.9</td>\n",
       "      <td>6.4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>132</th>\n",
       "      <td>6.4</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>133</th>\n",
       "      <td>6.3</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>6.1</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>135</th>\n",
       "      <td>7.7</td>\n",
       "      <td>6.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>136</th>\n",
       "      <td>6.3</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>137</th>\n",
       "      <td>6.4</td>\n",
       "      <td>5.5</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>138</th>\n",
       "      <td>6.0</td>\n",
       "      <td>4.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>139</th>\n",
       "      <td>6.9</td>\n",
       "      <td>5.4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>140</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>141</th>\n",
       "      <td>6.9</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>142</th>\n",
       "      <td>5.8</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143</th>\n",
       "      <td>6.8</td>\n",
       "      <td>5.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>144</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>145</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>146</th>\n",
       "      <td>6.3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>147</th>\n",
       "      <td>6.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148</th>\n",
       "      <td>6.2</td>\n",
       "      <td>5.4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>149</th>\n",
       "      <td>5.9</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>150 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     sepal length (cm)  petal length (cm)  target\n",
       "0                  5.1                1.4       0\n",
       "1                  4.9                1.4       0\n",
       "2                  4.7                1.3       0\n",
       "3                  4.6                1.5       0\n",
       "4                  5.0                1.4       0\n",
       "5                  5.4                1.7       0\n",
       "6                  4.6                1.4       0\n",
       "7                  5.0                1.5       0\n",
       "8                  4.4                1.4       0\n",
       "9                  4.9                1.5       0\n",
       "10                 5.4                1.5       0\n",
       "11                 4.8                1.6       0\n",
       "12                 4.8                1.4       0\n",
       "13                 4.3                1.1       0\n",
       "14                 5.8                1.2       0\n",
       "15                 5.7                1.5       0\n",
       "16                 5.4                1.3       0\n",
       "17                 5.1                1.4       0\n",
       "18                 5.7                1.7       0\n",
       "19                 5.1                1.5       0\n",
       "20                 5.4                1.7       0\n",
       "21                 5.1                1.5       0\n",
       "22                 4.6                1.0       0\n",
       "23                 5.1                1.7       0\n",
       "24                 4.8                1.9       0\n",
       "25                 5.0                1.6       0\n",
       "26                 5.0                1.6       0\n",
       "27                 5.2                1.5       0\n",
       "28                 5.2                1.4       0\n",
       "29                 4.7                1.6       0\n",
       "..                 ...                ...     ...\n",
       "120                6.9                5.7       2\n",
       "121                5.6                4.9       2\n",
       "122                7.7                6.7       2\n",
       "123                6.3                4.9       2\n",
       "124                6.7                5.7       2\n",
       "125                7.2                6.0       2\n",
       "126                6.2                4.8       2\n",
       "127                6.1                4.9       2\n",
       "128                6.4                5.6       2\n",
       "129                7.2                5.8       2\n",
       "130                7.4                6.1       2\n",
       "131                7.9                6.4       2\n",
       "132                6.4                5.6       2\n",
       "133                6.3                5.1       2\n",
       "134                6.1                5.6       2\n",
       "135                7.7                6.1       2\n",
       "136                6.3                5.6       2\n",
       "137                6.4                5.5       2\n",
       "138                6.0                4.8       2\n",
       "139                6.9                5.4       2\n",
       "140                6.7                5.6       2\n",
       "141                6.9                5.1       2\n",
       "142                5.8                5.1       2\n",
       "143                6.8                5.9       2\n",
       "144                6.7                5.7       2\n",
       "145                6.7                5.2       2\n",
       "146                6.3                5.0       2\n",
       "147                6.5                5.2       2\n",
       "148                6.2                5.4       2\n",
       "149                5.9                5.1       2\n",
       "\n",
       "[150 rows x 3 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iris = datasets.load_iris()\n",
    "x = pd.DataFrame(iris['data'], columns=iris['feature_names'])\n",
    "print(iris['data'].size)\n",
    "print(\"target_names: \"+str(iris['target_names']))\n",
    "y = pd.DataFrame(iris['target'], columns=['target'])\n",
    "iris_data = pd.concat([x,y], axis=1)\n",
    "iris_data = iris_data[['sepal length (cm)','petal length (cm)','target']]\n",
    "iris_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    iris_data[['sepal length (cm)','petal length (cm)']], iris_data['target'], test_size=0.3, random_state=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "60     1\n",
       "116    2\n",
       "144    2\n",
       "119    2\n",
       "108    2\n",
       "69     1\n",
       "135    2\n",
       "56     1\n",
       "80     1\n",
       "123    2\n",
       "133    2\n",
       "106    2\n",
       "146    2\n",
       "50     1\n",
       "147    2\n",
       "85     1\n",
       "30     0\n",
       "101    2\n",
       "94     1\n",
       "64     1\n",
       "89     1\n",
       "91     1\n",
       "125    2\n",
       "48     0\n",
       "13     0\n",
       "111    2\n",
       "95     1\n",
       "20     0\n",
       "15     0\n",
       "52     1\n",
       "      ..\n",
       "14     0\n",
       "122    2\n",
       "19     0\n",
       "29     0\n",
       "130    2\n",
       "49     0\n",
       "136    2\n",
       "99     1\n",
       "82     1\n",
       "79     1\n",
       "115    2\n",
       "145    2\n",
       "72     1\n",
       "77     1\n",
       "25     0\n",
       "81     1\n",
       "140    2\n",
       "142    2\n",
       "39     0\n",
       "58     1\n",
       "88     1\n",
       "70     1\n",
       "87     1\n",
       "36     0\n",
       "21     0\n",
       "9      0\n",
       "103    2\n",
       "67     1\n",
       "117    2\n",
       "47     0\n",
       "Name: target, Length: 105, dtype: int32"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "pandas.core.series.Series"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import StandardScaler\n",
    "sc = StandardScaler().fit(X_train)\n",
    "X_train_std = sc.transform(X_train)\n",
    "X_test_std = sc.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sepal length (cm)</th>\n",
       "      <th>petal length (cm)</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4.9</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4.7</td>\n",
       "      <td>1.3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4.6</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>4.6</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>4.4</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>4.9</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>4.8</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>4.8</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>4.3</td>\n",
       "      <td>1.1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>5.8</td>\n",
       "      <td>1.2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>5.7</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>5.7</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>5.4</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>4.6</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>4.8</td>\n",
       "      <td>1.9</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>5.2</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>5.2</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>4.7</td>\n",
       "      <td>1.6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>6.9</td>\n",
       "      <td>5.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>121</th>\n",
       "      <td>5.6</td>\n",
       "      <td>4.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>7.7</td>\n",
       "      <td>6.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123</th>\n",
       "      <td>6.3</td>\n",
       "      <td>4.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>7.2</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>6.2</td>\n",
       "      <td>4.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127</th>\n",
       "      <td>6.1</td>\n",
       "      <td>4.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>128</th>\n",
       "      <td>6.4</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129</th>\n",
       "      <td>7.2</td>\n",
       "      <td>5.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>130</th>\n",
       "      <td>7.4</td>\n",
       "      <td>6.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>131</th>\n",
       "      <td>7.9</td>\n",
       "      <td>6.4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>132</th>\n",
       "      <td>6.4</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>133</th>\n",
       "      <td>6.3</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>6.1</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>135</th>\n",
       "      <td>7.7</td>\n",
       "      <td>6.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>136</th>\n",
       "      <td>6.3</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>137</th>\n",
       "      <td>6.4</td>\n",
       "      <td>5.5</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>138</th>\n",
       "      <td>6.0</td>\n",
       "      <td>4.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>139</th>\n",
       "      <td>6.9</td>\n",
       "      <td>5.4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>140</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.6</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>141</th>\n",
       "      <td>6.9</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>142</th>\n",
       "      <td>5.8</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143</th>\n",
       "      <td>6.8</td>\n",
       "      <td>5.9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>144</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>145</th>\n",
       "      <td>6.7</td>\n",
       "      <td>5.2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>146</th>\n",
       "      <td>6.3</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>147</th>\n",
       "      <td>6.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148</th>\n",
       "      <td>6.2</td>\n",
       "      <td>5.4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>149</th>\n",
       "      <td>5.9</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>150 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     sepal length (cm)  petal length (cm)  target\n",
       "0                  5.1                1.4       0\n",
       "1                  4.9                1.4       0\n",
       "2                  4.7                1.3       0\n",
       "3                  4.6                1.5       0\n",
       "4                  5.0                1.4       0\n",
       "5                  5.4                1.7       0\n",
       "6                  4.6                1.4       0\n",
       "7                  5.0                1.5       0\n",
       "8                  4.4                1.4       0\n",
       "9                  4.9                1.5       0\n",
       "10                 5.4                1.5       0\n",
       "11                 4.8                1.6       0\n",
       "12                 4.8                1.4       0\n",
       "13                 4.3                1.1       0\n",
       "14                 5.8                1.2       0\n",
       "15                 5.7                1.5       0\n",
       "16                 5.4                1.3       0\n",
       "17                 5.1                1.4       0\n",
       "18                 5.7                1.7       0\n",
       "19                 5.1                1.5       0\n",
       "20                 5.4                1.7       0\n",
       "21                 5.1                1.5       0\n",
       "22                 4.6                1.0       0\n",
       "23                 5.1                1.7       0\n",
       "24                 4.8                1.9       0\n",
       "25                 5.0                1.6       0\n",
       "26                 5.0                1.6       0\n",
       "27                 5.2                1.5       0\n",
       "28                 5.2                1.4       0\n",
       "29                 4.7                1.6       0\n",
       "..                 ...                ...     ...\n",
       "120                6.9                5.7       2\n",
       "121                5.6                4.9       2\n",
       "122                7.7                6.7       2\n",
       "123                6.3                4.9       2\n",
       "124                6.7                5.7       2\n",
       "125                7.2                6.0       2\n",
       "126                6.2                4.8       2\n",
       "127                6.1                4.9       2\n",
       "128                6.4                5.6       2\n",
       "129                7.2                5.8       2\n",
       "130                7.4                6.1       2\n",
       "131                7.9                6.4       2\n",
       "132                6.4                5.6       2\n",
       "133                6.3                5.1       2\n",
       "134                6.1                5.6       2\n",
       "135                7.7                6.1       2\n",
       "136                6.3                5.6       2\n",
       "137                6.4                5.5       2\n",
       "138                6.0                4.8       2\n",
       "139                6.9                5.4       2\n",
       "140                6.7                5.6       2\n",
       "141                6.9                5.1       2\n",
       "142                5.8                5.1       2\n",
       "143                6.8                5.9       2\n",
       "144                6.7                5.7       2\n",
       "145                6.7                5.2       2\n",
       "146                6.3                5.0       2\n",
       "147                6.5                5.2       2\n",
       "148                6.2                5.4       2\n",
       "149                5.9                5.1       2\n",
       "\n",
       "[150 rows x 3 columns]"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iris_data\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "training accuracy: 0.9619047619047619\n",
      "test accuracy: 0.9555555555555556\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "lr = LogisticRegression(solver='lbfgs',multi_class='auto')\n",
    "lr.fit(X_train,y_train)\n",
    "print('training accuracy:',lr.score(X_train, y_train))\n",
    "print('test accuracy:',lr.score(X_test, y_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 1 0 0 1 1 0 2 1 0 2 2 1 0\n",
      " 2 1 1 2 0 2 0 0]\n"
     ]
    }
   ],
   "source": [
    "#prediction\n",
    "pred=lr.predict(X_test)\n",
    "print(pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "45"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(y_test.values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2 1 0 2 2 1 0\n",
      " 1 1 1 2 0 2 0 0]\n"
     ]
    }
   ],
   "source": [
    "#ground truth\n",
    "print(y_test.values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([24, 37], dtype=int64)"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "error_index=np.where(pred!=y_test.values)[0]\n",
    "error_index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sepal length (cm)</th>\n",
       "      <th>petal length (cm)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>114</th>\n",
       "      <td>5.8</td>\n",
       "      <td>5.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62</th>\n",
       "      <td>6.0</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>5.5</td>\n",
       "      <td>1.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>107</th>\n",
       "      <td>7.3</td>\n",
       "      <td>6.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     sepal length (cm)  petal length (cm)\n",
       "114                5.8                5.1\n",
       "62                 6.0                4.0\n",
       "33                 5.5                1.4\n",
       "107                7.3                6.3\n",
       "7                  5.0                1.5"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sepal length (cm)</th>\n",
       "      <th>petal length (cm)</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5.1</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4.9</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4.7</td>\n",
       "      <td>1.3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4.6</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5.0</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   sepal length (cm)  petal length (cm)  target\n",
       "0                5.1                1.4       0\n",
       "1                4.9                1.4       0\n",
       "2                4.7                1.3       0\n",
       "3                4.6                1.5       0\n",
       "4                5.0                1.4       0"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iris_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy: 0.9555555555555556\n",
      "error_index: [24 37]\n",
      "miss classification : [1 2]\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sepal length (cm)</th>\n",
       "      <th>petal length (cm)</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>6.2</td>\n",
       "      <td>4.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>83</th>\n",
       "      <td>6.0</td>\n",
       "      <td>5.1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     sepal length (cm)  petal length (cm)  target\n",
       "126                6.2                4.8       2\n",
       "83                 6.0                5.1       1"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "error_index=np.where(pred!=y_test.values)[0]\n",
    "print('accuracy:',1-len(error_index)/len(X_test))\n",
    "print('error_index:',error_index)\n",
    "print('miss classification :',pred[error_index])\n",
    "data_index=X_test.iloc[error_index].index\n",
    "iris_data.iloc[data_index]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## decision_regions for test data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sepal length (cm)</th>\n",
       "      <th>petal length (cm)</th>\n",
       "      <th>target</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>6.2</td>\n",
       "      <td>4.8</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>83</th>\n",
       "      <td>6.0</td>\n",
       "      <td>5.1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     sepal length (cm)  petal length (cm)  target\n",
       "126                6.2                4.8       2\n",
       "83                 6.0                5.1       1"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iris_data.iloc[data_index]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "X_test_nd=X_test.values\n",
    "plot_decision_regions(X_test_nd,y_test, classifier=lr)\n",
    "plt.xlabel('sepal length (cm)')\n",
    "plt.ylabel('petal length (cm)')\n",
    "plt.legend(loc='upper left')\n",
    "plt.tight_layout()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## decision_regions for training data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "X_train_nd=X_train.values\n",
    "plot_decision_regions(X_train_nd,y_train, classifier=lr)\n",
    "plt.xlabel('sepal length (cm)')\n",
    "plt.ylabel('petal length (cm)')\n",
    "plt.legend(loc='upper left')\n",
    "plt.tight_layout()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## getting the confusion matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "45"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_test.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[37]"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "[i for i in range(0,y_test.shape[0]) if y_test.values[i]==1 and pred[i]==2]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[24]"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "[i for i in range(0,y_test.shape[0]) if y_test.values[i]==2 and pred[i]==1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[16  0  0]\n",
      " [ 0 17  1]\n",
      " [ 0  1 10]]\n"
     ]
    }
   ],
   "source": [
    "a=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==0 and pred[i]==0])\n",
    "b=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==0 and pred[i]==1])\n",
    "c=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==0 and pred[i]==2])\n",
    "d=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==1 and pred[i]==0])\n",
    "e=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==1 and pred[i]==1])\n",
    "f=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==1 and pred[i]==2])\n",
    "g=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==2 and pred[i]==0])\n",
    "h=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==2 and pred[i]==1])\n",
    "i=len([i for i in range(0,y_test.shape[0]) if y_test.values[i]==2 and pred[i]==2])\n",
    "confusion_matrix=np.array([[a,b,c],[d,e,f],[g,h,i]])\n",
    "print(confusion_matrix)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
